{"id": "gafg1g", "title": "Using Deep Learning to Predict Earnings Outcomes", "selftext": "(Note: if you were following my earlier posts, I wrote a note at the end of this post explaining why I deleted old posts and what changed)\n\n**TLDR:** \n\n**Not financial advice.** \n\n* I created a deep learning algorithm trained on 2015-2019 data to predict whether a company will beat earning estimates. \n* Algorithm has an accuracy of 57%. \n* I need data and suggestions.\n* I\u2019ll be making daily posts for upcoming earnings.\n\nGreetings everyone,\n\nI\u2019m Bunga, an engineering PhD student at well known university. Like many of you, I developed an interest in trading because of the coronavirus. I lost a lot of money by being greedy and uninformed about how to actually trade options. With all the free time I have with my research slowing down because of the virus, I\u2019ve decided to use what I\u2019m good at (being a nerd, data analytics, and machine learning) to help me make trades. \n\nOne thing that stuck out to me was how people make bets on earnings reports. As a practitioner of machine learning, we LOVE binary events since the problem can be reduced to a simple binary classification problem. With that being said, I sought out to develop a machine learning algorithm to predict whether a company will beat earnings estimates.\n\nI strongly suggest **TO NOT USE THIS AS FINANCIAL ADVICE.** Please, I could just be a random guy on the internet making things up, and I could have bugs in my code. Just follow along for some fun and don\u2019t make any trades based off of this information \ud83d\ude0a \n\n**Things other people have tried:**\n\nA few other projects have tried to do this to some extent \\[1,2,3\\], but some are not directly predicting the outcome of the earnings report or have a very small sample size of a few companies.\n\n**The data**\n\nThis has been the most challenging part of the project. I\u2019m using data for 4,000 common stocks.\n\nOpen, high, low, close, volume stock data is often free and easy to come by. I use stock data during the quarter (Jan 1 \u2013 Mar 31 stock data for Q1 for example) in a time series classifier. I also incorporate \u201cbackground\u201d data from several ETFs to give the algorithm a feel for how the market is doing overall (hopefully this accounts for bull/bear markets when making predictions). \n\nI use sentiment analyses extracted from 10K/10Q documents from the previous quarter as described in \\[4\\]. This gets passed to a multilayer perceptron neural network. \n\nData that I\u2019ve tried and doesn\u2019t work to well:\n\nScraping 10K/10Q manually for US GAAP fields like Assets, Cash, StockholdersEquity, etc. Either I\u2019m not very good at processing the data or most of the tables are incomplete, this doesn\u2019t work well. However, I recently came across this amazing API \\[5\\] which will ameliorate most of these problems, and I plan on incorporating this data sometime this week.\n\n**Results**\n\nAfter training on about 34,000 data points, the model achieves a 58% accuracy on the test data. Class 1 is beat earnings, Class 2 is miss earnings.. Scroll to the bottom for the predictions for today\u2019s AMC estimates.  \n\n&#x200B;\n\nhttps://preview.redd.it/fqapvx2z1tv41.png?width=875&format=png&auto=webp&s=05ea5cae25ee5689edea334f2814e1fa73aa195d\n\n**Future Directions**\n\nThings I\u2019m going to try:\n\n* Financial twitter sentiment data (need data for this)\n* Data on options (ToS apparently has stuff that you can use)\n* Using data closer to the earnings report itself rather than just the data within the quarterly date\n\n**A note to the dozen people who were following me before**\n\nThank you so much for the early feedback and following. I had a bug in my code which was replicating datapoints, causing my accuracy to be way higher in reality. I\u2019ve modified some things to make the network only output a single value, and I\u2019ve done a lot of bug fixing.\n\n**Predictions for 4/29/20 AMC**:\n\nA value closer to 1 means that the company will be more likely to beat earnings estimates. Closer to 0 means the company will be more likely to miss earnings estimates. (People familiar with machine learning will note that neural networks don\u2019t actually output a probability distribution so the values don\u2019t actually represent a confidence). \n\n* Tkr: AAPL NN: 0.504\n* Tkr: AMZN NN: 0.544\n* Tkr: UAL NN: 0.438\n* Tkr: GILD NN: 0.532\n* Tkr: TNDM NN: 0.488\n* Tkr: X NN: 0.511\n* Tkr: AMGN NN: 0.642\n* Tkr: WDC NN: 0.540\n* Tkr: WHR NN: 0.574\n* Tkr: SYK NN: 0.557\n* Tkr: ZEN NN: 0.580\n* Tkr: MGM NN: 0.452\n* Tkr: ILMN NN: 0.575\n* Tkr: MOH NN: 0.500\n* Tkr: FND NN: 0.542\n* Tkr: TWOU NN: 0.604\n* Tkr: OSIS NN: 0.487\n* Tkr: CXO NN: 0.470\n* Tkr: BLDR NN: 0.465\n* Tkr: CASA NN: 0.568\n* Tkr: COLM NN: 0.537\n* Tkr: COG NN: 0.547\n* Tkr: SGEN NN: 0.486\n* Tkr: FMBI NN: 0.496\n* Tkr: PSA NN: 0.547\n* Tkr: BZH NN: 0.482\n* Tkr: LOCO NN: 0.575\n* Tkr: DLA NN: 0.460\n* Tkr: SSNC NN: 0.524\n* Tkr: SWN NN: 0.476\n* Tkr: RMD NN: 0.499\n* Tkr: VKTX NN: 0.437\n* Tkr: EXPO NN: 0.526\n* Tkr: BL NN: 0.516\n* Tkr: FTV NN: 0.498\n* Tkr: ASGN NN: 0.593\n* Tkr: KNSL NN: 0.538\n* Tkr: RSG NN: 0.594\n* Tkr: EBS NN: 0.483\n* Tkr: PRAH NN: 0.598\n* Tkr: RRC NN: 0.472\n* Tkr: ICBK NN: 0.514\n* Tkr: LPLA NN: 0.597\n* Tkr: WK NN: 0.630\n* Tkr: ATUS NN: 0.530\n* Tkr: FBHS NN: 0.587\n* Tkr: SWI NN: 0.521\n* Tkr: TRUP NN: 0.570\n* Tkr: AJG NN: 0.509\n* Tkr: BAND NN: 0.618\n* Tkr: DCO NN: 0.514\n* Tkr: BRKS NN: 0.490\n* Tkr: BY NN: 0.502\n* Tkr: CUZ NN: 0.477\n* Tkr: EMN NN: 0.532\n* Tkr: VICI NN: 0.310\n* Tkr: GLPI NN: 0.371\n* Tkr: MTZ NN: 0.514\n* Tkr: SEM NN: 0.405\n* Tkr: SPSC NN: 0.465\n\n\\[1\\] [https://towardsdatascience.com/forecasting-earning-surprises-with-machine-learning-68b2f2318936](https://towardsdatascience.com/forecasting-earning-surprises-with-machine-learning-68b2f2318936)\n\n\\[2\\] [https://zicklin.baruch.cuny.edu/wp-content/uploads/sites/10/2019/12/Improving-Earnings-Predictions-with-Machine-Learning-Hunt-Myers-Myers.pdf](https://zicklin.baruch.cuny.edu/wp-content/uploads/sites/10/2019/12/Improving-Earnings-Predictions-with-Machine-Learning-Hunt-Myers-Myers.pdf)\n\n\\[3\\] [https://www.euclidean.com/better-than-human-forecasts](https://www.euclidean.com/better-than-human-forecasts)\n\n\\[4\\] [https://cran.r-project.org/web/packages/edgar/edgar.pdf](https://cran.r-project.org/web/packages/edgar/edgar.pdf).\n\n\\[5\\] [https://financialmodelingprep.com/developer/docs/](https://financialmodelingprep.com/developer/docs/)", "created_utc": 1588187237.0, "permalink": "/r/wallstreetbets/comments/gafg1g/using_deep_learning_to_predict_earnings_outcomes/", "is_self": true}